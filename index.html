<!DOCTYPE html>
<html lang="en">
<title>Danny's Website</title>
<meta charset="UTF-8">
 <META NAME="ROBOTS" CONTENT="NOINDEX">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://unpkg.com/@optimizely/optimizely-sdk@2.0.0/dist/optimizely.browser.umd.min.js"></script>
<script src="https://cdn.optimizely.com/datafiles/2ikjPy1TerLpVsfmzH6B5m.json/tag.js"></script>
<script src="https://unpkg.com/launchdarkly-js-client-sdk@2"></script>

<script>
    ! function() {
      var analytics = window.analytics = window.analytics || [];
      if (!analytics.initialize)
          if (analytics.invoked) window.console && console.error && console.error("Segment snippet included twice.");
          else {
              analytics.invoked = !0;
              analytics.methods = ["trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset", "group", "track", "ready", "alias", "debug", "page", "once", "off", "on"];
              analytics.factory = function(t) {
                  return function() {
                      var e = Array.prototype.slice.call(arguments);
                      e.unshift(t);
                      analytics.push(e);
                      return analytics
                  }
              };
              for (var t = 0; t < analytics.methods.length; t++) {
                  var e = analytics.methods[t];
                  analytics[e] = analytics.factory(e)
              }
              analytics.load = function(t, e) {
                  var n = document.createElement("script");
                  n.type = "text/javascript";
                  n.async = !0;
                  n.src = "https://cdn.segment.com/analytics.js/v1/" + t + "/analytics.min.js";
                  var a = document.getElementsByTagName("script")[0];
                  a.parentNode.insertBefore(n, a);
                  analytics._loadOptions = e
              };
              analytics.SNIPPET_VERSION = "4.1.0";
             analytics.load("cRu0bGEoeheXjEQpAHopQHiKZuH47sr1");
  analytics.page();
  }}();
  analytics.identify("thisisauser");
</script>
  <script>
   window.optimizelyClientInstance = window.optimizelySdk.createInstance({datafile:optimizelyDatafile})
   window.onLog = function(logEvent) {
    console.log(logEvent)
    window.logEvent = logEvent
    }
 function segmentDecision(decisionObject) {
  var type = decisionObject.type
  //When a decision is generated by a Feature Flag, dispatch an event named Feature Flag, with properties denoting the feature key and other decision information
  if (type == "feature") {
    var info = decisionObject.decisionInfo;
    var featureKeyString = info.featureKey;
    var enabled = info.featureEnabled;
    var attributes = info.attributes;
    analytics.track('Feature Flag', {
      "key": featureKeyString,
      "enabled": enabled,
      info,
      attributes
    });
    //If the Feature Flag decision is a result of a feature test, dispatch an additional Experiment Viewed semantic event (https://segment.com/docs/connections/spec/ab-testing/)
    if (info.source == "feature-test") {
      var experimentKeyString =info.sourceInfo.experimentKey;
      var experimentVarString = info.sourceInfo.variationKey;
      analytics.track('Experiment Viewed', {
        'experiment_name': experimentKeyString,
        'variation_name': experimentVarString
      })
    }

  }
}
window.onActivate = function(activate){
 console.log(activate)
 window.activateEvent = activate;
}   
window.onTrack = function(event){
  console.log(event);
  window.event = event;
}
optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.ACTIVATE,onActivate);
   optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.LOG_EVENT,onLog);
   optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.DECISION,segmentDecision);
   optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.TRACK,onTrack);

   
</script>
  <script src="https://cdn-pci.optimizely.com/js/1378063170.js"></script>
 
<style>
body {font-family: "Lato", sans-serif}
.mySlides {display: none}
</style>
<body>

<div> Hey Mike!!</div>
 <script>
    var user = {
    firstName: 'Bob',
    lastName: 'Loblaw',
    key: 'UNIQUE IDENTIFIER',
    custom: {
      groups: 'beta_testers'
    }
  };

  var div = document.createElement('div');
  document.body.appendChild(div);

  div.appendChild(document.createTextNode('Initializing...'));

  var ldclient = LDClient.initialize('5f315f92c8369f081c5cde87', user);

  function render() {
    var shouldShow = ldclient.variation('test-flag', false);
    var label = (shouldShow ? 'Showing' : 'Not showing') + ' your feature to ' + user.key;
    div.replaceChild(document.createTextNode(label), div.firstChild);
  }

  ldclient.on('ready', render);
  ldclient.on('change', render);
</script>
</body>
</html>
