<!DOCTYPE html>
<html lang="en">
<title>Danny's Website</title>
<meta charset="UTF-8">
 <META NAME="ROBOTS" CONTENT="NOINDEX">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://unpkg.com/@optimizely/optimizely-sdk/dist/optimizely.browser.umd.min.js"></script>
<script src="https://cdn.optimizely.com/datafiles/15gywErrhRhKGHaTJCBw9Z.json/tag.js"></script>
<script src="https://unpkg.com/launchdarkly-js-client-sdk@2"></script>

<script>
    ! function() {
      var analytics = window.analytics = window.analytics || [];
      if (!analytics.initialize)
          if (analytics.invoked) window.console && console.error && console.error("Segment snippet included twice.");
          else {
              analytics.invoked = !0;
              analytics.methods = ["trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset", "group", "track", "ready", "alias", "debug", "page", "once", "off", "on"];
              analytics.factory = function(t) {
                  return function() {
                      var e = Array.prototype.slice.call(arguments);
                      e.unshift(t);
                      analytics.push(e);
                      return analytics
                  }
              };
              for (var t = 0; t < analytics.methods.length; t++) {
                  var e = analytics.methods[t];
                  analytics[e] = analytics.factory(e)
              }
              analytics.load = function(t, e) {
                  var n = document.createElement("script");
                  n.type = "text/javascript";
                  n.async = !0;
                  n.src = "https://cdn.segment.com/analytics.js/v1/" + t + "/analytics.min.js";
                  var a = document.getElementsByTagName("script")[0];
                  a.parentNode.insertBefore(n, a);
                  analytics._loadOptions = e
              };
              analytics.SNIPPET_VERSION = "4.1.0";
             analytics.load("cRu0bGEoeheXjEQpAHopQHiKZuH47sr1");
  analytics.page();
  }}();
  analytics.identify("thisisauser");
</script>
  <script>
  <pre>Welcome to our Quickstart Guide!</pre>
  <pre id="errors"></pre>
  <pre id="experiences"></pre>
  <pre id="result"></pre>
  <script>
    var optimizelyClient = window.optimizelySdk.createInstance({
      sdkKey: '<YOUR_SDK_KEY>'
    });

    optimizelyClient.onReady().then(() => {
      var errors = document.getElementById('errors');
      if (!optimizelyClient.isValidInstance()) {
        errors.innerText = 'Optimizely client invalid. Verify in Settings>Environments that you used the primary environment\'s SDK key';

        return;
      }

      var experiences = document.getElementById('experiences');
      let hasOnFlags = false;
      for (let i = 0; i < 10; i++) {
        // to get rapid demo results, generate random users. Each user always sees the same variation unless you reconfigure the flag rule.
        let userId = (Math.floor(Math.random() * (10000 - 1000) + 1000)).toString();

        // Create hardcoded user & bucket user into a flag variation
        let user = optimizelyClient.createUserContext(userId);

        // "product_sort" corresponds to a flag key in your Optimizely project
        let decision = user.decide('product_sort');
        let variationKey = decision.variationKey;

        // did decision fail with a critical error?
        if (variationKey === null) {
          errors.innerText += `\n\ndecision error: ${decision['reasons']}`;
        }

        // get a dynamic configuration variable
        // "sort_method" corresponds to a variable key in your Optimizely project
        let sortMethod = decision.variables['sort_method'];

        if (decision.enabled) {
          hasOnFlags = true;
        }

        // Mock what the users sees with print statements (in production, use flag variables to implement feature configuration)
        // always returns false until you enable a flag rule in your Optimizely project
        experiences.innerText += `\n\nFlag ${decision.enabled ? 'on' : 'off'}. User number ${user.getUserId()} saw flag variation: ${variationKey} and got products sorted by: ${sortMethod} config variable as part of flag rule: ${decision.ruleKey}`;
      }

      var result = document.getElementById('result');
      if (!hasOnFlags) {
        result.innerText = "\n\nFlag was off for everyone. Some reasons could include:" +
          "\n1. Your sample size of visitors was too small. Rerun, or increase the iterations in the FOR loop" +
          "\n2. By default you have 2 keys for 2 project environments (dev/prod). Verify in Settings>Environments that you used the right key for the environment where your flag is toggled to ON." +
          "\n\nCheck your key at https://app.optimizely.com/v2/projects/" + optimizelyClient.projectConfigManager.getConfig().projectId + "/settings/implementation";
      };
    });
  
 function segmentDecision(decisionObject) {
  var type = decisionObject.type
  //When a decision is generated by a Feature Flag, dispatch an event named Feature Flag, with properties denoting the feature key and other decision information
  if (type == "feature") {
    var info = decisionObject.decisionInfo;
    var featureKeyString = info.featureKey;
    var enabled = info.featureEnabled;
    var attributes = info.attributes;
    analytics.track('Feature Flag', {
      "key": featureKeyString,
      "enabled": enabled,
      info,
      attributes
    });
    //If the Feature Flag decision is a result of a feature test, dispatch an additional Experiment Viewed semantic event (https://segment.com/docs/connections/spec/ab-testing/)
    if (info.source == "feature-test") {
      var experimentKeyString =info.sourceInfo.experimentKey;
      var experimentVarString = info.sourceInfo.variationKey;
      analytics.track('Experiment Viewed', {
        'experiment_name': experimentKeyString,
        'variation_name': experimentVarString
      })
    }

  }
}
window.onActivate = function(activate){
 console.log(activate)
 window.activateEvent = activate;
}   
window.onTrack = function(event){
  console.log(event);
  window.event = event;
}
optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.ACTIVATE,onActivate);
   optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.LOG_EVENT,onLog);
   optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.DECISION,segmentDecision);
   optimizelyClientInstance.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.TRACK,onTrack);

   
</script>
  <script src="https://cdn-pci.optimizely.com/js/1378063170.js"></script>
 
<style>
body {font-family: "Lato", sans-serif}
.mySlides {display: none}
</style>
<body>

<div> Hey Mike, Greg or Ray!!</div>
 <script>
  
</script>
</body>
</html>
